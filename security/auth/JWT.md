# JWT를 통한 인증

### JSON Web Token

- 각 사용자에게 지정된 고유한 값을 활용하여 생성(sign)된 문자열.

- 누구나 담겨있는 내용 이해 가능한 토큰하므로 개인 정보 사용하면 안 됨.
- 해슁되지 않음. 암호화되지도 않고, 세션DB를 경유하지도 않음.
  - [사이트](https://jwt.io/)에서 decode 가능

### 인증 시스템 구현: token을 sign하고 verfy하는 알고리즘만 구현 필요

1. 서버에서 Sign 알고리즘 구현. Sign 알고리즘에 필요한 Secret Key는 환경변수로 숨기기.
2. 사용자가 ID+비번으로 로그인 성공시, 서버는 DB의 사용자 관련 정보 중 한 가지(ex. userId, 별도의 컬럼)를 Sign 알고리즘을 통해 토큰으로 변환.
3. 변환된 문자열을 브라우저로 전송하고, 브라우저는 해당 토큰을 쿠키 등의 형식으로 저장.
4. 로그인된 사용자가 다른 요청을 보낼 때 쿠키로부터 토큰 값을 읽어내고 해당 값을 Authorazation 헤더에 담아서 서버에 보냄.
5. 서버는 Authorazation 헤더 값에서 토큰의 존재여부를 체크.
6. 서버에서 토큰이 유효한지 체크하고, 유효하면 사용자로 인증.
7. 토큰을 decode하고 서비스 호출하여 요청 처리. DB 조회를 통해 로그인한 사용자가 구체적으로 누군지 체크 가능. DB의 데이터 수정할 때 그대로 사용 가능.

### 특징

- 브라우저: 서버로부터 토큰을 받아 쿠키 등의 형식으로 저장하고 요청을 보낼 때 함께 보냄.
- 서버: 요청에 담겨오는 토큰이 유효한지만 검증.

### 장점

- 사용자 인증 과정 단순화.
- 세션DB 불필요.
- 성능 개선.

### 단점 및 제약

- 생성된 토큰을 추적 불가 => 쿠키의 유효기간 설정 등의 작업만 가능
- 서버는 요청에 담겨있는 토큰이 유효한지의 여부만 확인 가능.
- 강제 로그아웃 등의 기능 구현 불가.

### 주의

- sign/verify에 사용한 secret key는 숨겨야 함. 그렇지 않으면 자유롭게 해당 토큰 위조 가능.
