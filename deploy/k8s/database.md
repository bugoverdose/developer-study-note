# k8s에서의 DB 연동

- 다양한 방법으로 DB 연동 가능.
- 기본적으로 쿠버네티스 클러스터의 외부에 DB 서버를 별도로 실행시키고, 해당 DB와 연동하는 구조.
- GCP, AWS EKS 등 배포 환경에 따라 관련 공식문서를 확인하여 구현하는 것이 가장 정확할 것.

### 예시: Proxy Pattern의 DB 연동 기법

- 각 서버 애플리케이션에서 직접 DB에 연동하는 것이 아니라, DB와 통신하는 중간다리 역할의 컨테이너를 각 Pod 내부에 하나씩 함께 실행하는 구조.
- 복수의 Pod 및 컨테이너들에서 공통적으로 외부에 존재하는 특정 DB와 통신하는 경우, 각 서버 애플리케이션은

1. 각 Pod가 배포될 때 DB 프록시 컨테이너도 함께 실행됨. 해당 컨테이너는 외부에 존재하는 DB와 연동된 상태를 유지

2. Pod 내에서 컨테이너로 배포된 서버 애플리케이션은 포트번호를 통해 해당 DB 프록시 컨테이너와 통신함(localhost:3306)

3. DB 프록시 컨테이너가 대신 외부에 존재하는 DBMS와 통신하며 SQL문을 날리고 조회결과 등을 응답 받아, 서버 애플리케이션으로 응답결과를 전달함.
